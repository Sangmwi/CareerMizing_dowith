<!DOCTYPE html>
<html lang="kr">
  <head>
    <!--  Title -->
    <title>CareerMizing</title>
    <!--  Required Meta Tag -->
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="handheldfriendly" content="true" />
    <meta name="MobileOptimized" content="width" />
    <meta name="description" content="Mordenize" />
    <meta name="author" content="" />
    <meta name="keywords" content="Mordenize" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!--  Favicon -->
    <link rel="shortcut icon" type="image/png" href="../assets/images/logos/favicon.ico" />
    <!-- Owl Carousel  -->
    <link rel="stylesheet" href="../../dist/libs/owl.carousel/dist/assets/owl.carousel.min.css">
    
    <!-- Core Css -->
    <link  id="themeColors"  rel="stylesheet" href="../../dist/css/style.min.css" />
  </head>
  <body>
    <!-- Preloader -->
    <div class="preloader">
      <img src="../assets/images/logos/favicon.ico" alt="loader" class="lds-ripple img-fluid" />
    </div>
    <!-- Preloader -->
    <div class="preloader">
      <img src="../assets/images/logos/favicon.ico" alt="loader" class="lds-ripple img-fluid" />
    </div>
    <!--  Body Wrapper -->
    <div class="page-wrapper" id="main-wrapper" data-theme="blue_theme"  data-layout="vertical" data-sidebartype="full" data-sidebar-position="fixed" data-header-position="fixed">
      <!-- Sidebar Start -->
      <aside class="left-sidebar">
        <!-- Sidebar scroll-->
        <div>
          <div class="brand-logo d-flex align-items-center justify-content-between">
            <a href="./index.html" class="text-nowrap logo-img">
              <img src="../assets/images/logos/dark-logo.svg" class="dark-logo" width="180" alt="" />
              <img src="../assets/images/logos/light-logo.svg" class="light-logo"  width="180" alt="" />
            </a>
            <div class="close-btn d-lg-none d-block sidebartoggler cursor-pointer" id="sidebarCollapse">
              <i class="ti ti-x fs-8 text-muted"></i>
            </div>
          </div>
          <!-- Sidebar navigation-->
          <nav class="sidebar-nav scroll-sidebar" data-simplebar>
            <ul id="sidebarnav">
              <!-- ============================= -->
              <!-- Home -->
              <!-- ============================= -->
              <li class="nav-small-cap">
                <i class="ti ti-dots nav-small-cap-icon fs-4"></i>
                <span class="hide-menu">Home</span>
              </li>
              <!-- =================== -->
              <!-- Dashboard -->
              <!-- =================== -->
              <li class="sidebar-item">
                <a class="sidebar-link" href="./CR-index.html" aria-expanded="false">
                  <span>
                    <i class="ti ti-home"></i>
                  </span>
                  <span class="hide-menu">홈</span>
                </a>
              </li>
              <li class="sidebar-item">
                <a class="sidebar-link" href="./CR-consult.html" aria-expanded="false">
                  <span>
                    <i class="ti ti-target"></i>
                  </span>
                  <span class="hide-menu">컨설팅</span>
                </a>
              </li>
              <li class="sidebar-item">
                <a class="sidebar-link" href="./CR-community.html" aria-expanded="false">
                  <span>
                    <i class="ti ti-file"></i>
                  </span>
                  <span class="hide-menu">커뮤니티</span>
                </a>
              </li>
              <li class="sidebar-item">
                <a class="sidebar-link" href="./CR-chat.html" aria-expanded="false">
                  <span>
                    <i class="ti ti-cpu"></i>
                  </span>
                  <span class="hide-menu">채팅이야기</span>
                </a>
              </li>
              <li class="sidebar-item">
                <a class="sidebar-link" href="./CR-info.html" aria-expanded="false">
                  <span>
                    <i class="ti ti-activity-heartbeat"></i>
                  </span>
                  <span class="hide-menu">정보</span>
                </a>
              </li>
               

               
            </ul>
            <div class="unlimited-access hide-menu bg-light-primary position-relative my-7 rounded">
              <div class="d-flex">
                <div class="unlimited-access-title">
                  <h6 class="fw-semibold fs-4 mb-6 text-dark w-85">내 역량을 확인해보세요</h6>
                  <button class="btn btn-primary fs-2 fw-semibold lh-sm">내 프로필</button>
                </div>
                <div class="unlimited-access-img">
                  <img src="../assets/images/backgrounds/rocket.png" alt="" class="img-fluid">
                </div>
              </div>
            </div>
          </nav>










          <div class="fixed-profile p-3 bg-light-secondary rounded sidebar-ad mt-3">
            <div class="hstack gap-3">
              <div class="john-img">
                <img src="../assets/images/profile/user-1.jpg" class="rounded-circle" width="40" height="40" alt="">
              </div>
              <div class="john-title">
                <h6 class="mb-0 fs-4 fw-semibold">Name</h6>
                <span class="fs-2 text-dark">Designer</span>
              </div>
              <button class="border-0 bg-transparent text-primary ms-auto" tabindex="0" type="button" aria-label="logout" data-bs-toggle="tooltip" data-bs-placement="top" data-bs-title="logout">
                <i class="ti ti-power fs-6"></i>
              </button>
            </div>
          </div>  
          <!-- End Sidebar navigation -->
        </div>
        <!-- End Sidebar scroll-->
      </aside>
      <!--  Sidebar End -->
      <!--  Main wrapper -->
      <div class="body-wrapper">
        <!--  Header Start -->
        <header class="app-header"> 
          <nav class="navbar navbar-expand-lg navbar-light">
            <ul class="navbar-nav">
              <li class="nav-item">
                <a class="nav-link sidebartoggler nav-icon-hover ms-n3" id="headerCollapse" href="javascript:void(0)">
                  <i class="ti ti-menu-2"></i>
                </a>
              </li>
             
              
            </ul>
            
            
            <div class="d-block d-lg-none">
              <img src="../assets/images/logos/dark-logo.svg" class="dark-logo" width="180" alt="" />
              <img src="../assets/images/logos/light-logo.svg" class="light-logo"  width="180" alt="" />
            </div>
            <button class="navbar-toggler p-0 border-0" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
              <span class="p-2">
                <i class="ti ti-dots fs-7"></i>
              </span>
            </button>
            <div class="collapse navbar-collapse justify-content-end" id="navbarNav">
              <div class="d-flex align-items-center justify-content-between">
                <a href="javascript:void(0)" class="nav-link d-flex d-lg-none align-items-center justify-content-center" type="button" data-bs-toggle="offcanvas" data-bs-target="#mobilenavbar" aria-controls="offcanvasWithBothOptions">
                  <i class="ti ti-align-justified fs-7"></i>
                </a>
                <ul class="navbar-nav flex-row ms-auto align-items-center justify-content-center">
                  
                  <li class="nav-item dropdown">
                    <a class="nav-link pe-0" href="javascript:void(0)" id="drop1" data-bs-toggle="dropdown" aria-expanded="false">
                      <div class="d-flex align-items-center">
                        <div class="user-profile-img">
                          <img src="../hahaprofile.jpeg" class="rounded-circle" width="35" height="35" alt="" />
                        </div>
                      </div>
                    </a>
                    <div class="dropdown-menu content-dd dropdown-menu-end dropdown-menu-animate-up" aria-labelledby="drop1">
                      <div class="profile-dropdown position-relative" data-simplebar>
                        <div class="py-3 px-7 pb-0">
                          <h5 class="mb-0 fs-5 fw-semibold">User Profile</h5>
                        </div>
                        <div class="d-flex align-items-center py-9 mx-7 border-bottom">
                          <img src="../hahaprofile.jpeg" class="rounded-circle" width="80" height="80" alt="" />
                          <div class="ms-3">
                            <h5 id="username" class="mb-1 fs-3">이름</h5>
                            <span id="usertype" class="mb-1 d-block text-dark"> - </span>
                            <p id="usermail" class="mb-0 d-flex text-dark align-items-center gap-2">
                              <i class="ti ti-mail fs-4"></i> email@net
                            </p>
                          </div>
                        </div>
                        <div class="message-body">
                          <a href="./CR-profile.html" class="py-8 px-7 mt-8 d-flex align-items-center">
                            <span class="d-flex align-items-center justify-content-center bg-light rounded-1 p-6">
                              <img src="../assets/images/svgs/icon-account.svg" alt="" width="24" height="24">
                            </span>
                            <div class="w-75 d-inline-block v-middle ps-3">
                              <h6 class="mb-1 bg-hover-primary fw-semibold"> 내 프로필 </h6>
                              <span class="d-block text-dark">프로필을 설정하고 관리합니다</span>
                            </div>
                          </a>
                          
                        </div>
                        <div class="d-grid py-4 px-7 pt-8">
                          <a href="./CR-authentification.html" class="btn btn-outline-primary"><span id="loginmenu">로그인/가입</span></a>
                        </div>
                      </div>
                    </div>
                  </li>
                </ul>
              </div>
            </div>
          </nav>
        </header>
        <!-- --------------------------------------------------- -->
        <!-- Header End -->
        <!-- --------------------------------------------------- -->
        <div class="container-fluid">
   
          
          <div class="row chat-application">
           


            <div class="card col-md-6 col-lg-8" style="height: 700px;"><!---
              <div class="w-30 d-none d-lg-block border-end user-chat-box">
                 
                
              </div>-->
              <div class="chat-container">
                <div class="chat-box-inner-part h-100">
                  <div class="chat-not-selected h-100 d-none">
                    <div class="d-flex align-items-center justify-content-center h-100 p-5">
                      <div class="text-center">
                        <span class="text-primary">
                          <i class="ti ti-message-dots fs-10"></i>
                        </span>
                        <h6 class="mt-2">Open chat from the list</h6>
                      </div>
                    </div>
                  </div>
                  <div class="chatting-box d-block">
                    <div class="p-9 border-bottom chat-meta-user d-flex align-items-center justify-content-between">
                      <div class="hstack gap-3 current-chat-user-name">
                        <div class="position-relative">
                          <img src="../hahaprofile.jpeg" alt="user1" width="48" height="48" class="rounded-circle" />
                          <span class="position-absolute bottom-0 end-0 p-1 badge rounded-pill bg-success">
                            <span class="visually-hidden">New alerts</span>
                          </span>
                        </div>
                        <div class="">
                          <h6 class="mb-1 name fw-semibold"></h6>
                          <p class="mb-0">커리어마이징 채팅</p>
                        </div>
                      </div>
                      <ul class="list-unstyled mb-0 d-flex align-items-center">
                        <li><a class="text-dark px-2 fs-7 bg-hover-primary nav-icon-hover position-relative z-index-5 " href="javascript:void(0)"><i class="ti ti-phone"></i></a></li>
                        <li><a class="text-dark px-2 fs-7 bg-hover-primary nav-icon-hover position-relative z-index-5 " href="javascript:void(0)"><i class="ti ti-video"></i></a></li>
                        <li>
                          <!-- <a class="text-dark px-2 fs-7 bg-hover-primary nav-icon-hover position-relative z-index-5 " href="javascript:void(0)" type="button" data-bs-toggle="offcanvas" data-bs-target="#app-chat-offcanvas" aria-controls="offcanvasScrolling">
                            <i class="ti ti-menu-2"></i>
                          </a> -->
                          <a class="chat-menu text-dark px-2 fs-7 bg-hover-primary nav-icon-hover position-relative z-index-5" href="javascript:void(0)">
                            <i class="ti ti-menu-2"></i>
                          </a>
                        </li>
                      </ul>
                    </div>
                    <div class="position-relative overflow-hidden d-flex">
                      <div class="position-relative d-flex flex-grow-1 flex-column">
                        <div class="chat-box p-9" style="height: calc(100vh - 300px)" data-simplebar>
                          <div class="chat-list chat active-chat" data-user-id="1">




                            <div class="messages">
                              <div class="messages-content"></div>
                            </div>


                            <!---
                            <div class="hstack gap-3 align-items-start mb-7 justify-content-start">
                              <img src="../yohahaprofile.jpeg" alt="User" width="40" height="40" class="rounded-circle" />
                              <div>
                                <h6 class="fs-2 text-muted">상대방이채팅보낸시간</h6>
                                <div class="p-2 bg-light rounded-1 d-inline-block text-dark fs-3"> 나는 상대방 채팅이야 </div>
                              </div>
                            </div>


                            <div class="hstack gap-3 align-items-start mb-7 justify-content-end">
                              <div class="text-end">
                                <h6 class="fs-2 text-muted">채팅보낸시간</h6>
                                <div class="p-2 bg-light-info text-dark rounded-1 d-inline-block fs-3"> 내가 보낸 채팅이야 </div>
                              </div>
                            </div>
                            -->
                              



                          </div>
                           
                        </div>
                        <div class="px-9 py-6 border-top chat-send-message-footer">
                          <div class="d-flex align-items-center justify-content-between">
                            
                            
                            <div class="d-flex align-items-center gap-2 w-85">
                              <a class="position-relative nav-icon-hover z-index-5" href="javascript:void(0)"> <i class="ti ti-mood-smile text-dark bg-hover-primary fs-7"></i></a>
                              <input type="text" id="message" class="message-input form-control message-type-box text-muted border-0 p-0 ms-2" placeholder="메시지 입력..." />
                           
                            </div>
                            <ul class="list-unstyledn mb-0 d-flex align-items-center"><!----
                              <li><a class="text-dark px-2 fs-7 bg-hover-primary nav-icon-hover position-relative z-index-5 " href="javascript:void(0)"><i class="ti ti-photo-plus"></i></a></li>
                              <li><a class="text-dark px-2 fs-7 bg-hover-primary nav-icon-hover position-relative z-index-5 " href="javascript:void(0)"><i class="ti ti-paperclip"></i></a></li>-->
                              <li><a class="text-dark px-2 fs-7 bg-hover-primary nav-icon-hover position-relative z-index-5 " href="javascript:void(0)"><i class="ti ti-send"></i></a></li>
                              <button type="submit" style="font-size :13px" class="message-submit">보내기</button>

                            </ul>
                          </div>
                        </div>
                      </div> 
                                           
                    </div>
                  </div>
                </div>
              </div>
              
            </div>
          </div>
        </div>
      </div>
    <div class="dark-transparent sidebartoggler"></div>
    <div class="dark-transparent sidebartoggler"></div>
    </div>
    <!--  Shopping Cart -->
    
    <!--  Mobilenavbar -->
    
    <!--  Search Bar -->
     
    <!-- --------------------------------------------------- -->
    <!-- Customizer -->
    <!-- --------------------------------------------------- -->
    
  
        <!-- ---------------------------------------------- -->
    <!-- Customizer -->
    <!-- ---------------------------------------------- -->
    <!-- ---------------------------------------------- -->
    <!-- Import Js Files -->
    <!-- ---------------------------------------------- -->
    <script src="../../dist/libs/jquery/dist/jquery.min.js"></script>
    <script src="../../dist/libs/jquery-ui/dist/jquery-ui.min.js"></script>
    <script src="../../dist/libs/simplebar/dist/simplebar.min.js"></script>
    <script src="../../dist/libs/bootstrap/dist/js/bootstrap.bundle.min.js"></script>
    <script src="../../dist/js/app.min.js"></script>
    <script src="../../dist/js/app.init.js"></script>
    <script src="../../dist/js/app-style-switcher.js"></script>
    <script src="../../dist/js/sidebarmenu.js"></script>
    <script src="../../dist/js/custom.js"></script>
    <!-- ---------------------------------------------- -->
    <!-- current page js files -->
    <!-- ---------------------------------------------- -->
    <script src="../assets/js/time.js"></script>
    <script src="../assets/js/sessionCheck.js"></script>
    <script src="https://www.gstatic.com/firebasejs/4.10.1/firebase.js"></script>

  

<script src='http://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js'></script>
<script src='https://cdnjs.cloudflare.com/ajax/libs/malihu-custom-scrollbar-plugin/3.1.3/jquery.mCustomScrollbar.concat.min.js'></script>

<script>
  var firebaseEmailAuth; // Firebase email 인증 모듈 전역변수
  var firebaseDatabase; // Firebase db 모듈 전역변수
  var name; // 유저 이름
  var loginUserKey; // 로그인한 유저의 부모 key
  var userInfo; // 로그인한 유저의 정보 object type
  var brdno;
  var uids; // 사용자 UID 저장할 변수

  // Firebase 초기화 코드
  var config = {
      apiKey: "AIzaSyAffW1gPzgFKgiwGw4OBa9o1umQ8YGpaE8",
      authDomain: "careermizing.firebaseapp.com",
      databaseURL: "https://careermizing-default-rtdb.firebaseio.com",
      projectId: "careermizing",
      storageBucket: "careermizing.appspot.com",
      messagingSenderId: "836478653396",
      appId: "1:836478653396:web:f1178a28045faa90dc7c41",
      measurementId: "G-BK8DTN3C6Y"
  };

  // Firebase 초기화
  firebase.initializeApp(config);
  firebaseEmailAuth = firebase.auth();
  firebaseDatabase = firebase.database();

  userSessionCheck();




</script>
<script>
// 사용자 인증 상태 체크 및 UID 설정
firebaseEmailAuth.onAuthStateChanged(user => {
  if (user) {
      uids = user.uid; // 현재 로그인한 사용자의 UID를 변수에 저장
      initializeApp(); // 사용자 UID가 설정된 후 앱 초기화
  } else {
      // 사용자 로그인하지 않은 경우, 로그인 페이지로 리디렉션
      window.location.href = "CR-authentification.html";
  }
});

function initializeApp() {
  // 로그인한 유저가 있을 때 실행할 코드
  boardListFun(); // 보드 리스트 로드
}

function boardListFun() {
  if (uids) {
      var thanksRef = firebaseDatabase.ref('anounymous');
      thanksRef.on('child_added', on_thanks_list);

      var thanksRef = firebaseDatabase.ref('notice');
      thanksRef.on('child_added', on_notice_list);
  } else {
      alert("비 로그인 유저에게는 게시물이 표시되지 않습니다.");
      window.location.href = "CR-authentification.html";
  }
}

function on_thanks_list(data) {
  var key = data.key;
  var Data = data.val();
  var comment = Data.comment;
  var createtime = Data.createtime;
  var name = Data.name;
  var subject = Data.subject;
  var userkey = Data.userkey;
  var cmtcount = Data.cmtcount;
  var brdnm = Data.boardno;
  var boardno = Data.key; // 이 보드의 키값
}

function scrollToBottom() {
  var messages = document.querySelector('.messages-content');
  var lastMessage = messages.lastElementChild;

  if (lastMessage) {
      lastMessage.scrollIntoView({
          behavior: 'smooth',
          block: 'end',
          inline: 'nearest'
      });
  }
}

firebase.database().ref("messages").on("child_removed", function(snapshot) {
  document.getElementById("message-" + snapshot.key).innerHTML = "[삭제된 메시지]";
});

function deleteMessage(self) {
  var messageId = self.getAttribute("data-id");
  firebase.database().ref("messages").child(messageId).remove();
}

function sendMessage() {
  var d = new Date();
  var year = d.getFullYear().toString();
  var month = (d.getMonth() + 1).toString();
  var day = d.getDate().toString();
  var hours = d.getHours().toString();
  var min = d.getMinutes().toString();
  var sec = d.getSeconds().toString();
  var currentTime = year + "년" + month + "월" + day + "일" + hours + ":" + min;

  var message = document.getElementById("message").value;

  if (message.indexOf('섹스') != -1 || message.indexOf('병신') != -1 || message.indexOf('애미') != -1 || message.indexOf('sex') != -1 || message.indexOf('문재인') != -1 || message.indexOf('새끼') != -1 || message.indexOf('자위') != -1 || message.indexOf('딸딸') != -1 || message.indexOf('ddd') != -1) {
      alert("민감하거나 부정적인 단어가 포함되어 있습니다.");
  } else {
      firebase.database().ref("messages").push().set({
          "message": message,
          "sender": uids, // 메시지 보내는 사람의 UID
          "nick": name,
          "name": name,
          "msgtime": currentTime
      });

      firebase.database().ref("msglog").push().set({
          "message": message,
          "sender": uids, // 메시지 보내는 사람의 UID
          "nick": name,
          "name": name,
          "msgtime": currentTime
      });

      return false;
  }
}

function sendmsglog() {
  var d = new Date();
  var year = d.getFullYear().toString();
  var month = (d.getMonth() + 1).toString();
  var day = d.getDate().toString();
  var hours = d.getHours().toString();
  var min = d.getMinutes().toString();
  var sec = d.getSeconds().toString();
  var currentTime = year + "년" + month + "월" + day + "일" + hours + ":" + min;

  var msg = document.getElementById("msglog").value;
  firebase.database().ref("msglog").push().set({
      "message": msg,
      "sender": uids, // 메시지 보내는 사람의 UID
      "nick": name,
      "name": name,
      "msgtime": currentTime
  });
  return false;
}


var $messages = $('.messages-content'),
  d, h, m,
  i = 0;

var myName = "";




$(window).load(function() {




  //유저의 UID 가져오기
  //temp = location.href.split("?");
  //data=temp[1].split("/");
  //uids = data[0];


  //로그인되어 있으면 넘기기
  firebase.auth().onAuthStateChanged(user => {
      if (user) {
          var uids = user.uid;
          //alert('User is logged in with UID: ' + uids);

          chats();


      } else {
          alert('로그인해주세요.');
          location.href="CR-index.html";
      }
  });




  function chats() {




      var foodItems = ["나무늘보", "황조롱이", "있잖아", "나는 ", "사실", "사과", "나뭇잎", "그냥 익명이", "바나나", "막대기", "SKT T1 FAKER", "고양이", "삼색이", "이얏호응", "무", "연필", "띠이모", "강아지", "빨간 모자", "그냥 학생", "내 꿈은 세계정복", "나 누구게", "갈매기"];
      var randomz = foodItems[Math.floor(Math.random() * foodItems.length)];


      //ncNamec = prompt("익명으로 사용할 일회성 닉네임 입력");

      myName = uids
      //ncName = randomz + " " + ncNamec

      $messages.mCustomScrollbar();

      firebase.database().ref("messages").on("child_added", function(snapshot) {
          if (snapshot.val().sender == myName) {
              //나자신이보낸 메시지


              // 관리자 ADMIN
              if (snapshot.val().sender == "kMywHo4jNSM0ybV5cYctttif7Hu1") {
                  $('<div class="hstack gap-3 align-items-start mb-7 justify-content-end">' +
                      '<div class="text-end">' +
                      '<h6 class="fs-2 text-muted">' + snapshot.val().name + '</h6>' +
                      '<div class="p-2 bg-light-info text-dark rounded-1 d-inline-block fs-3" id="message-' + snapshot.key + '">' + snapshot.val().message +
                      '<button class="btn-delete" data-id="' + snapshot.key + '" onclick="deleteMessage(this);">X</button>' +
                      '</div>' +
                      '</div>' +
                      '</div>'
                  ).appendTo($('.mCSB_container')).addClass('new');

                  $('.message-input').val(null);

              } else {


                  // 그냥 나 자신
                  $('<div class="hstack gap-3 align-items-start mb-7 justify-content-end">' +
                      '<div class="text-end">' +
                      '<h6 class="fs-2 text-muted">' + "나" + '</h6>' +
                      '<div class="p-2 bg-light-info text-dark rounded-1 d-inline-block fs-3" id="message-' + snapshot.key + '">' + snapshot.val().message + " " +
                      '<button class="btn-delete" data-id="' + snapshot.key + '" onclick="deleteMessage(this);">❌</button>' +
                      '</div>' +
                      '</div>' +
                      '</div>'
                  ).appendTo($('.mCSB_container')).addClass('new');


                  // $('<div class="message message-personal"> <figure class="avatar"><img src="https://cdn.iconscout.com/icon/free/png-256/user-1648810-1401302.png" /></figure>  <div id="message-' + snapshot.key + '">' + snapshot.val().message + '<button class="btn-delete" data-id="' + snapshot.key + '" onclick="deleteMessage(this);">X</button></div></div>').appendTo($('.mCSB_container')).addClass('new');

                  $('.message-input').val(null);

                  scrollToBottom();
              }



          } else {
              // $('<div class="message new"><figure class="avatar"><img src="https://cdn1.iconfinder.com/data/icons/basic-22/512/1041_boy_c-512.png" /></figure><div id="message-' + snapshot.key + '">' + snapshot.val().sender + ': ' + snapshot.val().message + '</div></div>').appendTo($('.mCSB_container')).addClass('new');



              if (snapshot.val().sender == "kMywHo4jNSM0ybV5cYctttif7Hu1") {
                  //관리자가 보내는 메시지
                  $('<div class="hstack gap-3 align-items-start mb-7 justify-content-end">' +
                      '<div class="text-end">' +
                      '<h6 class="fs-2 text-muted">' + snapshot.val().name + '</h6>' +
                      '<div class="p-2 bg-light-info text-dark rounded-1 d-inline-block fs-3" id="message-' + snapshot.key + '">' + snapshot.val().message +
                      '<button class="btn-delete" data-id="' + snapshot.key + '" onclick="deleteMessage(this);">X</button>' +
                      '</div>' +
                      '</div>' +
                      '</div>'
                  ).appendTo($('.mCSB_container')).addClass('new');

              } else {

                  //일반유저가 보내는 메시지

                  $('<div class="hstack gap-3 align-items-start mb-7 justify-content-start">' +
                      '<img src="../yohahaprofile.jpeg" alt="User" width="40" height="40" class="rounded-circle" />' +
                      '<div>' +
                      '<h6 class="fs-2 text-muted">' + snapshot.val().name + '</h6>' +
                      '<div class="p-2 bg-light rounded-1 d-inline-block text-dark fs-3" id="message-' + snapshot.key + '">' + snapshot.val().message + '</div>' +
                      '</div>' +
                      '</div>'
                  ).appendTo($('.mCSB_container')).addClass('new');




              }
          }




          setDate();
          updateScrollbar();
      });


  }


});

function updateScrollbar() {
  $messages.mCustomScrollbar("update").mCustomScrollbar('scrollTo', 'bottom', {
      scrollInertia: 10,
      timeout: 0
  });
}

function setDate() {

  //냘짜 함수
  var d = new Date();
  var year = d.getFullYear().toString();
  var month = (d.getMonth() + 1).toString();
  var day = d.getDate().toString();
  var hours = d.getHours().toString();
  var min = d.getMinutes().toString();
  var sec = d.getSeconds().toString();
  var currentTime = year + "." + month + "." + day + "." + hours + ":" + min;


  if (m != d.getMinutes()) {
      m = d.getMinutes();
      $('<div class="timestamp">' + currentTime + '</div>').appendTo($('.message:last'));
  }
}

function insertMessage() {
  msg = $('.message-input').val();
  if ($.trim(msg) == '') {
      return false;
  }

  sendMessage();
  //sendmsglog();
}

$('.message-submit').click(function() {
  insertMessage();
});

$(window).on('keydown', function(e) {
  if (e.which == 13) {
      insertMessage();
      return false;
  }
});
      </script>

  </body>
</html>
